select '2013-2014'fin_yr,NEW_PROJECT_CODE,SUBSTR(OLD_ASSET_CODE,5,1)CAT,sum(PURCHASE_VALUE)Amount from   TEST_ASSESTS
WHERE RECEIPT_DATE BETWEEN '01-Apr-13' and '31-Mar-14' AND SUBSTR(OLD_ASSET_CODE,5,1)='C'
GROUP BY '2013-2014',NEW_PROJECT_CODE,SUBSTR(OLD_ASSET_CODE,5,1) 
ORDER BY NEW_PROJECT_CODE,SUBSTR(OLD_ASSET_CODE,5,1)



1. SELECT distinct A.FIN_YR,A.PROJECT_CODE,A.CAT Account_Asset_Cat,m.cat Material_Asset_Cat,A.AMOUNT AS ACCOUNT_AMOUNT,M.AMOUNT AS MATERIAL_AMOUNT
 FROM MATERIAL_ASSET M,ACCOUNT_ASSET A
WHERE M.FIN_YR=A.FIN_YR AND M.NEW_PROJECT_CODE=A.PROJECT_CODE AND M.AMOUNT=A.AMOUNT AND M.CAT=A.CAT



2. SELECT distinct A.FIN_YR,A.PROJECT_CODE,A.CAT Account_Asset_Cat,m.cat Material_Asset_Cat,A.AMOUNT AS ACCOUNT_AMOUNT,M.AMOUNT AS MATERIAL_AMOUNT
 FROM MATERIAL_ASSET M,ACCOUNT_ASSET A
WHERE M.FIN_YR=A.FIN_YR AND M.NEW_PROJECT_CODE=A.PROJECT_CODE AND M.AMOUNT<>A.AMOUNT AND M.CAT=A.CAT







3. select distinct project_code,amount,fin_yr,cat from ACCOUNT_ASSET where project_code||cat in (select project_code||cat from (
SELECT project_code,cat FROM ACCOUNT_ASSET 
minus 
select new_project_code project_code,cat from MATERIAL_ASSET))





